#SHACL shapes for high-risk AI as per Annex III of AI Act, Final version https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=CELEX:52021PC0206

@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix airo: <https://w3id.org/airo#> .
@prefix vair: <https://w3id.org/vair#> .
@prefix ex: <https://example.com/ns#> .

ex:AnnexIII-1a
    a sh:NodeShape ;
    sh:targetClass airo:AISystem ;
    sh:message "High-Risk as per AI Act Annex III-1a: Biometrics, remote biometric identification systems."@en ;
    sh:description "Remote biometric identification systems"@en ;
    sh:not [sh:and (
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasPurpose ;
                    sh:class vair:RemoteIdentification ;
                
                ]
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasCapability ;
                    sh:class vair:BiometricIdentification ;
                ]

                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasAISubject ;
                    sh:class vair:NaturalPerson ;
                ]

                )] .
 

ex:AnnexIII-1b
    a sh:NodeShape ;
    sh:targetClass airo:AISystem ;
    sh:message "High-Risk as per AI Act Annex III-1b: Biometrics, AI systems intended to be used for biometric categorisation, according to sensitive or protected attributes or characteristics based on the inference of those attributes or characteristics."@en ;
    sh:description "Biometric categorisation systems"@en ;
    sh:not [sh:and (
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasPurpose ;
                    sh:class vair:Categorisation ;
                
                ]
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasCapability ;
                    sh:or (
                        [
                            sh:class vair:BiometricCategorisation ;
                        ]
                         [
                            sh:class vair:SensitiveAttributeInference ;
                        ]

                    )    

                ]

                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasAISubject ;
                    sh:class vair:NaturalPerson ;
                ]

                )] .

 ex:AnnexIII-1c
    a sh:NodeShape ;
    sh:targetClass airo:AISystem ;
    sh:message "High-Risk as per AI Act Annex III-1c: Biometrics, AI systems intended to be used for emotion recognition."@en ;
    sh:description "Emotion recognition systems"@en ;
    sh:not [sh:and (
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasPurpose ;
                    sh:or (
                        [
                            sh:class vair:RecognisingEmotions ; 
                        ]
                        [
                            sh:class vair:DetectingEmotionalState ;
                        ]

                    )
                
                ]
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasCapability ;
                    sh:or (
                        [
                            sh:class vair:EmotionSensing ;
                        ]
                         [
                            sh:class vair:BiometricsBasedEmotionSensing ;
                        ]

                    )    

                ]

                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasAISubject ;
                    sh:class vair:NaturalPerson ;
                ]

                )] . 

ex:AnnexIII-2
    a sh:NodeShape ;
    sh:targetClass airo:AISystem ;
    sh:message "High-Risk as per Annex III-2: Critical infrastructure: AI systems intended to be used as safety components in the management and operation of critical digital infrastructure, road traffic, or in the supply of water, gas, heating or electricity."@en ;
    sh:description "safety components in the management and operation of critical digital infrastructure, road traffic, or in the supply of water, gas, heating or electricity"@en ;
    sh:not [sh:and (
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:isAppliedWithinDomain ;
                    sh:class vair:CriticalInfrastructure ;

                ]
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasPurpose ;
                    sh:or (
                        [
                            sh:class vair:ServingSafetyFunctionInOperationOfCriticalDigitalInfrastructure ;
 
                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInManagementOfCriticalDigitalInfrastructure ;
 
                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInOperationOfRoadTraffic ;

                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInManagementOfRoadTraffic ;

                        ]
                        [
                            sh:class  vair:ServingSafetyFunctionInOperationOfTheSupplyOfWater ;

                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInManagementOfTheSupplyOfWater ;

                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInOperationOfTheSupplyOfGas ;
                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInManagementOfTheSupplyOfGas ;

                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInOperationOfTheSupplyOfHeating ;

                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInManagementOfTheSupplyOfHeating ;

                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInOperationOfTheSupplyOfElectricity ;
 
                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInManagementOfTheSupplyOfElectricity ;
                        ]
   

                    )
                
                ]               


                )] . 

ex:AnnexIII-3a
    a sh:NodeShape ;
    sh:targetClass airo:AISystem ;
    sh:message "High-Risk as per Annex III-3a: Education and vocational training, AI systems intended to be used to determine access or admission or to assign natural persons to educational and vocational training institutions at all levels."@en ;
    sh:description "AI Systems fot determining access or admission or to assign natural persons to educational and vocational training institutions"@en ;
     sh:not [sh:and (
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:isAppliedWithinDomain ;
                    sh:class vair:Education ;
                ]
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasPurpose ;
                    sh:or  (
                        [
                            sh:class vair:DeterminingAccessToEducationalInstitutions ;

                        ]
                        [
                            sh:class vair:DeterminingAccessToVocationalTrainingInstitutions ;

                        ]
                        [
                            sh:class vair:DeterminingAdmissionToEducationalInstitutions ;

                        ]
                        [
                            sh:class vair:DeterminingAdmissionToVocationalTrainingInstitutions ;

                        ]
                        [
                            sh:class vair:AssigningPersonsToEducationalInstitutions ;
                        ]
                        [
                            sh:class vair:AssigningPersonsToVocationalTrainingInstitutions ;

                        ]
                    )

                ]
            sh:property [
                a sh:PropertyShape ;
                sh:path airo:hasAISubject ;
                sh:class vair:NaturalPerson ;
                ]    

     )
     ].
ex:AnnexIII-3b
    a sh:NodeShape ;
    sh:targetClass airo:AISystem ;
    sh:message "High-Risk as per AI Act Annex III-3b: Education and vocational training, AI systems intended to be used to evaluate learning outcomes, including when those outcomes are used to steer the learning process of natural persons in educational and vocational training institutions at all levels."@en ;
    sh:description "AI systems for evaluating learning outcomes"@en ;
    sh:not [sh:and (
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:isAppliedWithinDomain ;
                    sh:class vair:Education ;
                ]

                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasPurpose ;
                    sh:class vair:EvaluatingLearningOutcomes ;
                   
                ]
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:isDeployedBy ;
                    sh:or (
                        [
                            sh:class vair:EducationalInstitution ; 
                        ]
                        [
                            sh:class vair:VocationalTrainingInstitution ; 
                        ]
                    )


                ]
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasAISubject ;
                    sh:or (
                    [ 
                        sh:class vair:CourseAttendee ; 
                    ]
                    [ 
                        sh:class vair:NaturalPerson ;
                    ]
                    )
                ]
                
                )] .   

ex:AnnexIII-3c
    a sh:NodeShape ;
    sh:targetClass airo:AISystem ;
    sh:message "High-Risk as per AI Act Annex III-3c: Education and vocational training, AI systems intended to be used for the purpose of assessing the appropriate level of education that an individual will receive or will be able to access, in the context of or within educational and vocational training institutions at all levels."@en ;
    sh:description "AI systems for assessing the appropriate level of education"@en ;
    sh:not [sh:and (
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:isAppliedWithinDomain ;
                    sh:class vair:Education ;
                ]

                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasPurpose ;
                    sh:or (
                        [
                            sh:class vair:AssessingLevelOfEducation ;  
                        ]
                        [
                            sh:class vair:AssessingAccessibleLevelOfEducation ;
                        ]
                    )
                   
                ]
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:isDeployedBy ;
                    sh:or (
                        [
                            sh:class vair:EducationalInstitution ; 
                        ]
                        [
                            sh:class vair:VocationalTrainingInstitution ; 
                        ]
                    )


                ]
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasAISubject ;
                    sh:class vair:NaturalPerson ;   
                ]
                
                )] . 
ex:AnnexIII-3d
    a sh:NodeShape ;
    sh:targetClass airo:AISystem ;
    sh:message "High-Risk as per AI Act Annex III-3d: Education and vocational training, AI systems intended to be used for monitoring and detecting prohibited behaviour of students during tests in the context of or within educational and vocational training institutions at all levels."@en ;
    sh:description "AI systems for monitoring and detecting prohibited behaviour of students"@en ;
    sh:not [sh:and (
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:isAppliedWithinDomain ;
                    sh:class vair:Education ;
                ]

                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasPurpose ;
                    sh:or (
                        [
                            sh:class vair:MonitoringProhibitedBehaviourDuringTest  ;  
                        ]
                        [
                            sh:class vair:DetectingProhibitedBehaviourDuringTest ;
                        ]
                    )
                   
                ]
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:isDeployedBy ;
                    sh:or (
                        [
                            sh:class vair:EducationalInstitution ; 
                        ]
                        [
                            sh:class vair:VocationalTrainingInstitution ; 
                        ]
                    )


                ]
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasAISubject ;
                    sh:class vair:Student ;   
                ]
                
                )] . 

ex:AnnexIII-4a
    a sh:NodeShape ;
    sh:targetClass airo:AISystem ;
    sh:message "High-Risk as per AI Act Annex III-4a: Employment, workersâ€™ management and access to self-employment: AI systems intended to be used for the recruitment or selection of natural persons, in particular to place targeted job advertisements, to analyse and filter job applications, and to evaluate candidates."@en ;
    sh:description "AI systems for recruitment or selection of natural persons, to place targeted job advertisements, to analyse and filter job applications, and to evaluate candidates;"@en ;
    sh:not [sh:and (
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:isAppliedWithinDomain ;
                    sh:class vair:Employment ;
                ]
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasPurpose ;
                    sh:or (
                    [
                        sh:class vair:Recruiting ;
                    ]
                    [
                        sh:class vair:SelectingPeople ;
                    ]
                    [
                        sh:class  vair:PlacingTargetedJobAdvert ;
                    ]
                    
                    [
                        sh:class vair:JobApplicationAnalysis ;
                    ]
                    [
                        sh:class vair:JobApplicationScreening ;
                    ]
                    [
                        sh:class vair:JobApplicationFiltering;
                    ]
                    [
                        sh:class vair:EvaluatingJobInterview ;
                    ]
                    [
                        sh:class vair:EvaluatingJobCandidates ;
                    ]

                    )
  
                ]
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasAISubject ;
                    sh:or (
                    [
                        sh:class vair:JobApplicant ;
                    ]
                    [
                        sh:class vair:PotentialJobApplicant ;
                    ]
                    [
                        sh:class vair:JobCandidate ;
                    ]
                    [
                        sh:class vair:NaturalPerson ;
                    ]
                    
                    )
                ]
                
                )] .
