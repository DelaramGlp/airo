#SHACL shapes for high-risk AI as per Annex III of AI Act, Final version https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=CELEX:52021PC0206

@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix airo: <https://w3id.org/airo#> .
@prefix vair: <https://w3id.org/vair#> .
@prefix ex: <https://example.com/ns#> .

ex:AnnexIII-1a
    a sh:NodeShape ;
    sh:targetClass airo:AISystem ;
    sh:message "High-Risk as per AI Act Annex III-1a: Biometrics, remote biometric identification systems."@en ;
    sh:description "Remote biometric identification systems"@en ;
    sh:not [sh:and (
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasPurpose ;
                    sh:class vair:RemoteIdentification ;
                
                ]
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasCapability ;
                    sh:class vair:BiometricIdentification ;
                ]

                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasAISubject ;
                    sh:class vair:NaturalPerson ;
                ]

                )] .
 

ex:AnnexIII-1b
    a sh:NodeShape ;
    sh:targetClass airo:AISystem ;
    sh:message "High-Risk as per AI Act Annex III-1b: Biometrics, AI systems intended to be used for biometric categorisation, according to sensitive or protected attributes or characteristics based on the inference of those attributes or characteristics."@en ;
    sh:description "Biometric categorisation systems"@en ;
    sh:not [sh:and (
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasPurpose ;
                    sh:class vair:Categorisation ;
                
                ]
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasCapability ;
                    sh:or (
                        [
                            sh:class vair:BiometricCategorisation ;
                        ]
                         [
                            sh:class vair:SensitiveAttributeInference ;
                        ]

                    )    

                ]

                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasAISubject ;
                    sh:class vair:NaturalPerson ;
                ]

                )] .

 ex:AnnexIII-1c
    a sh:NodeShape ;
    sh:targetClass airo:AISystem ;
    sh:message "High-Risk as per AI Act Annex III-1c: Biometrics, AI systems intended to be used for emotion recognition."@en ;
    sh:description "Emotion recognition systems"@en ;
    sh:not [sh:and (
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasPurpose ;
                    sh:or (
                        [
                            sh:class vair:RecognisingEmotions ; 
                        ]
                        [
                            sh:class vair:DetectingEmotionalState ;
                        ]

                    )
                
                ]
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasCapability ;
                    sh:or (
                        [
                            sh:class vair:EmotionSensing ;
                        ]
                         [
                            sh:class vair:BiometricsBasedEmotionSensing ;
                        ]

                    )    

                ]

                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasAISubject ;
                    sh:class vair:NaturalPerson ;
                ]

                )] . 

ex:AnnexIII-2
    a sh:NodeShape ;
    sh:targetClass airo:AISystem ;
    sh:message "High-Risk as per Annex III-2: Critical infrastructure: AI systems intended to be used as safety components in the management and operation of critical digital infrastructure, road traffic, or in the supply of water, gas, heating or electricity."@en ;
    sh:description "safety components in the management and operation of critical digital infrastructure, road traffic, or in the supply of water, gas, heating or electricity"@en ;
    sh:not [sh:and (
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:isAppliedWithinDomain ;
                    sh:class vair:CriticalInfrastructure ;

                ]
                sh:property [
                    a sh:PropertyShape ;
                    sh:path airo:hasPurpose ;
                    sh:or (
                        [
                            sh:class vair:ServingSafetyFunctionInOperationOfCriticalDigitalInfrastructure ;
 
                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInManagementOfCriticalDigitalInfrastructure ;
 
                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInOperationOfRoadTraffic ;

                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInManagementOfRoadTraffic ;

                        ]
                        [
                            sh:class  vair:ServingSafetyFunctionInOperationOfTheSupplyOfWater ;

                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInManagementOfTheSupplyOfWater ;

                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInOperationOfTheSupplyOfGas ;
                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInManagementOfTheSupplyOfGas ;

                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInOperationOfTheSupplyOfHeating ;

                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInManagementOfTheSupplyOfHeating ;

                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInOperationOfTheSupplyOfElectricity ;
 
                        ]
                        [
                            sh:class vair:ServingSafetyFunctionInManagementOfTheSupplyOfElectricity ;
                        ]
   

                    )
                
                ]               


                )] . 